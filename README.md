cmdrecplay
==============

`Cmdrecplay` is a tool for a C/C++ checker of emacs flycheck.
This tool consist of `cmdrec` and `cmdplay`.
`cmdrec` examines makefile of your projects, then records compiler options for make
process, such as -D, -I, -W, -f, -std, etc., to a sqlite3 database `~/.cmdrec.db`.
`cmdplay` works a part of C/C++ checker of emacs flycheck, then refers this database,
and invoke compiler such as clang with correct options.

Sqlite3 database `~/.cmdrec.db` remembers histories of compiling, so, if you remove
this database file, then informations on the correct option will disappear.

Thanks
------

Thanks bear protocol written by Laszlo Nagy. `cmdrecplay` uses bear protocol.
Bear's approach is system call hacking by `LD_PRELOAD`,
and `cmdrecplay` uses its approach too.
Bear uses the JSON compilation database, but `cmdrecplay` uses the sqlite3 database.
For more detail, see https://github.com/rizsotto/Bear .

How to build
------------

cmdrec/cmdplay should be quite portable on UNIX OSs, it has been tested on FreeBSD,
Linux and OS X only.

### Prerequisites

1. ANSI **C compiler** to compile the sources.
2. **cmake** to configure the build process.
3. **pkg-config** to find dependencies during configure step.
4. **make** to run the build. Makefiles are generated by `cmake`.
5. **libconfig** to parse the config file. (Version shall be greater than 1.4)
6. **sqlite3** to link the executables.
7. **oniguruma** to link the executables.

### Build commands

It could be the best to build it in a separate build directory.

    mkdir build
    cd build
    cmake ..
    make all
    sudo make install # to install

You can configure the build process with passing arguments to cmake.
For example, debug configuration is the follows,

    mkdir build
    cd build
    cmake -DCMAKE_BUILD_TYPE=Debug ..
    make all


How to use
----------

After installation, append the following line in your emacs startup file:

    (require 'cmdplay)

First, per your project:

    cd <your_project_directory_which_contains_your_makefile>
    cmdrec -- make

The `--` separates the parameters from the build command. The output sqlite3 file
`~/.cmdrec.db` found in your home directory.
For more options, you can check by passing `-h` parameter to `cmdrec` or `cmdplay` commands.

From now on, you can edit your project's C/C++ source files by emacs flycheck, without specifying include pathes or macro defines explicitly.
If your include pathes or macro defines are changed, then you need to executing `cmdrec -- make` again.

Known issues
------------

Problem reports
---------------

If you find a bug in this documentation or elsewhere in the program or would
like to propose an improvement, please use the project's [github issue
tracker][ISSUES]. Please describing the bug and where you found it. If you
have a suggestion how to fix it, include that as well. Patches are also
welcome.

  [ISSUES]: https://github.com/DrScKAWAMOTO/cmdrecplay


Author
------

* Dr.Sc.KAWAMOTO,Takuji (Ext)
* 川本 琢二（Ｅｘｔ）
* System Architect (Panasonic Advanced Technology Development Co., Ltd.)
* システム・アーキテクト (パナソニック アドバンストテクノロジー(株))
* Doctor of Science (Mathematics)
* 理学博士 (数学)
* Jazz Pianist
* ジャズ・ピアニスト
* My Representative Freeware Works: Prolog-TK over LISP,TwentyOne,DEDIT,TeX previewer,fontman,WiZ backup tool,nm.x,sort.x,hounds,assembler,dis-assembler,TCP/IP over ITRON,FullereneViewer,cmdrecplay,ifendif
